const a=document.getElementById("urlInput"),b=document.getElementById("qrForm"),c=document.getElementById("qrCodeContainer"),d=document.getElementById("downloadContainer"),e=/^https?:\/\/([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}([\/?#].*)?$/;
a.addEventListener("input",()=>{let f=a.value.trim();if(!f){a.classList.remove("is-valid","is-invalid");return}!/^https?:\/\//i.test(f)&&f.includes(".")&&(f="https://"+f,a.value=f),e.test(f)?(a.classList.remove("is-invalid"),a.classList.add("is-valid")):(a.classList.remove("is-valid"),a.classList.add("is-invalid"))});
b.addEventListener("submit",g=>{g.preventDefault();const f=a.value.trim();if(!e.test(f)){a.classList.add("is-invalid");a.focus();return}c.innerHTML="",d.innerHTML="",new QRCode(c,{text:f,width:250,height:250,correctLevel:QRCode.CorrectLevel.H}),setTimeout(()=>{const h=c.querySelector("canvas");if(!h)return;const i=800,j=40,k=i+2*j,l=document.createElement("canvas");l.width=k,l.height=k;const m=l.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,k,k),m.imageSmoothingEnabled=!1,m.drawImage(h,j,j,i,i);const n=l.toDataURL("image/png"),o=document.createElement("a"),p=new URL(f).hostname;o.href=n,o.download=p+".png",o.className="btn btn-success mt-2",o.textContent="Download QR Code",d.appendChild(o)},100)});
